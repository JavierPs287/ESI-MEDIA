<div class="register-container">
  <h1 class="form-title">Crea un Creador de Contenido</h1>
  <p class="form-subtitle">Sube tu contenido para que otros lo descubran.</p>

  <!-- Mensaje de √©xito -->
  <div class="success-message" *ngIf="successMessage">
    <p>‚úÖ {{ successMessage }}</p>
  </div>

  <!-- Mensaje de error -->
  <div class="error-message-box" *ngIf="errorMessage">
    <p>‚ùå {{ errorMessage }}</p>
  </div>

  <form [formGroup]="registerForm" >

    <!-- Campo: Nombre -->
    <div class="form-field">
    <label for="nombre">Nombre *</label>
    <input type="text" placeholder="Nombre" formControlName="nombre">
      <div class="error-container" *ngIf="getControl('nombre')?.invalid && (getControl('nombre')?.touched || getControl('nombre')?.dirty)">
        <p class ="error-message" *ngIf="getControl('nombre')?.hasError('required')"> El campo es obligatorio. </p>
        <p class ="error-message" *ngIf="getControl('nombre')?.hasError('minlength')"> M√≠nimo 2 caracteres. </p>
        <p class ="error-message" *ngIf="getControl('nombre')?.hasError('maxlength')"> M√°ximo 50 caracteres. </p>
      </div>
    </div>

    <!-- Campo: Apellido -->
    <div class="form-field">
      <label for="apellidos">Apellido *</label>
      <input type="text" placeholder="Apellido" formControlName="apellidos">
        <div class="error-container" *ngIf="getControl('apellidos')?.invalid && (getControl('apellidos')?.touched || getControl('apellidos')?.dirty)">
        <p class ="error-message" *ngIf="getControl('apellidos')?.hasError('required')"> El campo es obligatorio. </p>
        <p class ="error-message" *ngIf="getControl('apellidos')?.hasError('minlength')"> M√≠nimo 2 caracteres. </p>
        <p class ="error-message" *ngIf="getControl('apellidos')?.hasError('maxlength')"> M√°ximo 50 caracteres. </p>
      </div>
    </div>

    <!-- Campo: Email -->
    <div class="form-field">
      <label for="email">Email *</label>
      <input type="email" placeholder="Direcci√≥n de correo" formControlName="email">
        <div class="error-container" *ngIf="getControl('email')?.invalid && (getControl('email')?.touched || getControl('email')?.dirty)">
        <p class ="error-message" *ngIf="getControl('email')?.hasError('required')"> El campo es obligatorio. </p>
        <p class ="error-message" *ngIf="getControl('email')?.hasError('email')"> Formato de email inv√°lido. </p>
        </div>
    </div>

    <!-- Campo: Alias: UNICO no repetir -->
    <div class="form-field">
      <label for="alias">Alias *</label>
      <input type="text" placeholder="Alias" formControlName="alias">
      <div class="error-container" *ngIf="getControl('alias')?.invalid && (getControl('alias')?.touched || getControl('alias')?.dirty)">
        <p class ="error-message" *ngIf="getControl('alias')?.hasError('required')"> El campo es obligatorio. </p>
        <p class ="error-message" *ngIf="getControl('alias')?.hasError('minlength')"> M√≠nimo 2 caracteres. </p>
        <p class ="error-message" *ngIf="getControl('alias')?.hasError('maxlength')"> M√°ximo 20 caracteres. </p>
      </div>
    </div>

    <!-- Campo: Foto de perfil -->
    <div class="form-field">
      <label for="foto">Foto de perfil *</label>
      <button 
        type="button" class="photo-selector-btn" 
        (click)="togglePhotoOptions()">
        {{ selectedPhoto ? 'Cambiar foto' : 'Seleccionar foto' }}
      </button>

      <div class="photo-options" *ngIf="showPhotoOptions">
        <div class="photo-grid">
          <img *ngFor="let avatar of photoOptions" 
               [src]="avatar.url" 
               [alt]="avatar.name"
               class="photo-option"
               [class.selected]="selectedPhoto === avatar.url"
               (click)="selectPhoto(avatar.url)"
               (keydown.enter)="selectPhoto(avatar.url)">
        </div>
      <a class="link" href="http://www.freepik.com">Designed by studiogstock / Freepik</a>
      </div>
      <div class="error-container" *ngIf="getControl('fotoPerfil')?.invalid && (getControl('fotoPerfil')?.touched || getControl('fotoPerfil')?.dirty)">
        <p class ="error-message" *ngIf="getControl('fotoPerfil')?.hasError('required')"> El campo es obligatorio. </p>
      </div>
    </div>

    <!-- Campo: Descripci√≥n -->
    <div class="form-field">
      <label for="descripcion">Descripci√≥n</label>
      <textarea class="area-descripcion" placeholder="Descripci√≥n" formControlName="descripcion"></textarea>
      <div class="error-container" *ngIf="getControl('descripcion')?.invalid && (getControl('descripcion')?.touched || getControl('descripcion')?.dirty)">
        <p class ="error-message" *ngIf="getControl('descripcion')?.hasError('maxlength')"> M√°ximo 500 caracteres. </p>
      </div>
    </div>

    <!-- Campo: Especialidad -->
    <div class="form-field">
    <label for="especialidad">Especialidad *</label>
    <select class="form-select" id="especialidad" formControlName="especialidad">
      <option value="">Seleccionar especialidad</option>
      <option *ngFor="let esp of especialidades" [value]="esp">
        {{ esp }}
      </option>
    </select>
    <div class="error-container" *ngIf="getControl('especialidad')?.invalid && (getControl('especialidad')?.touched || getControl('especialidad')?.dirty)">
        <p class ="error-message" *ngIf="getControl('especialidad')?.hasError('required')"> El campo es obligatorio. </p>
    </div>
</div>

<!-- Campo: Tipo de Contenido -->
<div class="form-field">
    <label for="tipoContenido">Tipo de Contenido *</label>
    <div class="content-type-buttons">
    <button 
        type="button" class="content-btn"
        [class.active]="getControl('tipoContenido')?.value === 'Audio'"
        (click)="selectContentType('Audio')">üéµ Audio
    </button>
    <button 
        type="button" class="content-btn"
        [class.active]="getControl('tipoContenido')?.value === 'Video'"
        (click)="selectContentType('Video')">üé¨ Video
    </button>
    </div>
    <div class="error-container" *ngIf="getControl('tipoContenido')?.invalid && (getControl('tipoContenido')?.touched || getControl('tipoContenido')?.dirty)">
        <p class ="error-message" *ngIf="getControl('tipoContenido')?.hasError('required')"> El campo es obligatorio. </p>
    </div>    
</div>

    <!-- Campo: Contrase√±a -->
  <div class="form-field">
    <label for="contrasena">Contrase√±a *</label>
      <div class="password-field">
      <input [type]="!visiblePassword?'password':'text'" placeholder="Contrase√±a" formControlName="contrasena">
      <button class="eyeicon" (click)="togglePasswordVisibility()">
        <mat-icon *ngIf="visiblePassword">visibility</mat-icon>
        <mat-icon *ngIf="!visiblePassword">visibility_off</mat-icon>
      </button>
    </div>
    <div class="error-container" *ngIf="getControl('contrasena')?.invalid && (getControl('contrasena')?.touched || getControl('contrasena')?.dirty)">
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('required')"> El campo es obligatorio. </p>
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('minlength')"> M√≠nimo 8 caracteres. </p>
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('maxlength')"> M√°ximo 128 caracteres. </p>
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('noLowercase')">‚ùå Debe contener al menos una letra min√∫scula</p>
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('noUppercase')">‚ùå Debe contener al menos una letra may√∫scula</p>
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('noNumber')">‚ùå Debe contener al menos un n√∫mero</p>
      <p class ="error-message" *ngIf="getControl('contrasena')?.hasError('noSpecialChar')">‚ùå Debe contener al menos un car√°cter especial</p>
      </div>
  </div>

    <!-- Campo: Repetir Contrase√±a -->
    <div class="form-field">
      <label for="repetirContrasena">Repetir Contrase√±a *</label>
      <input type="password" placeholder="Repetir contrase√±a" formControlName="repetirContrasena">
      <div class="error-container" *ngIf="(getControl('repetirContrasena')?.invalid && (getControl('repetirContrasena')?.touched || getControl('repetirContrasena')?.dirty)) || (registerForm.errors?.['passwordMismatch'] && (getControl('repetirContrasena')?.touched || getControl('repetirContrasena')?.dirty))">
        <p class ="error-message" *ngIf="getControl('repetirContrasena')?.hasError('required')"> El campo es obligatorio. </p>
        <p class ="error-message" *ngIf="getControl('repetirContrasena')?.hasError('minlength')"> M√≠nimo 8 caracteres. </p>
        <p class ="error-message" *ngIf="getControl('repetirContrasena')?.hasError('maxlength')"> M√°ximo 128 caracteres. </p>
        <p class ="error-message" *ngIf="registerForm.errors?.['passwordMismatch'] && (getControl('repetirContrasena')?.touched || getControl('repetirContrasena')?.dirty)"> Las contrase√±as no coinciden. </p>
      </div>
    </div>

    <!-- Bot√≥n de env√≠o -->
    <button (click)="onSubmit()" [disabled]="!registerForm.valid || isSubmitting" type="submit" class="create-btn">
      {{ isSubmitting ? 'Registrando...' : 'Crear cuenta' }}
    </button>

</form>
</div>

